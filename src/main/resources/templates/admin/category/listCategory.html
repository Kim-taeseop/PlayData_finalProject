<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>카테고리 리스트</title>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script>
        function deleteCategory(categoryIdx) {
            var storeCode = [[${storeCode}]];
            $.ajax({
                type:"DELETE",
                url : "http://localhost:9010/category/deleteCategory",
                contentType: "application/json; charset=utf-8",
                async : false,
                data: JSON.stringify(categoryIdx),
                success: function (data) {
                    window.location.href ="http://localhost:9010/admin/"+storeCode+"/food";
                    alert(data)
                },
                error: function () {
                    alert("에러")
                }
            });
        }
    </script>
</head>
<body>
    <table border="1">
        <tr>
            <th></th>
            <th>카테고리명</th>
            <th>수정</th>
            <th>삭제</th>
        </tr>
        <tr th:each="category, index : *{listCategory}">
            <td th:text="${index.index + 1}">인덱스</td>
            <td th:text="${category.getName()}">카테고리명</td>
            <td><button th:onclick="|location.href='@{/{storeCode}/modifyCategoryForm(storeCode=${storeCode}, categoryIdx=${category.idx})}'|">수정</button></td>
            <td><button th:attr="onclick='deleteCategory(\'' + ${category.idx} + '\')'">삭제</button></td>
        </tr>
    </table>
    <button type="button" th:onclick="|location.href='@{/{storeCode}/addCategoryForm(storeCode=${storeCode})}'|">카테고리 추가</button>
</body>
</html>